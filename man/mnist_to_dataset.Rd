% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mnist_to_dataset.R
\name{mnist_to_dataset}
\alias{mnist_to_dataset}
\title{Préparer MNIST pour Keras/TensorFlow}
\usage{
mnist_to_dataset(
  validation_split = 0.2,
  image_size = c(28, 28),
  to_rgb = FALSE,
  batch_size = 64,
  subsample = NULL,
  seed = 123
)
}
\arguments{
\item{validation_split}{Proportion des données d'entraînement à utiliser
pour la validation (par défaut 0.2)}

\item{image_size}{Vecteur de taille 2 : (hauteur, largeur) en pixels.
Par défaut c(28, 28). Utilisez c(48, 48) pour MobileNetV2.}

\item{to_rgb}{Booléen. Si TRUE, convertit les images grayscale en RGB
(3 canaux). Par défaut FALSE.}

\item{batch_size}{Nombre d'exemples par batch (par défaut 64)}

\item{subsample}{Liste optionnelle avec éléments \code{train} et \code{test}
pour sous-échantillonner les données. Par exemple :
\code{list(train = 10000, test = 2000)}. Par défaut NULL (pas de sous-échantillonnage).}

\item{seed}{Graine aléatoire pour la reproductibilité (par défaut 123)}
}
\value{
Une liste avec trois éléments :
\describe{
\item{train}{Dataset d'entraînement (tf_dataset)}
\item{validation}{Dataset de validation (tf_dataset)}
\item{test}{Dataset de test (tf_dataset)}
}
}
\description{
Convertit le dataset MNIST en datasets TensorFlow compatibles avec
validation split, redimensionnement et batching.
}
\details{
Cette fonction effectue automatiquement :
\itemize{
\item La normalisation des pixels (division par 255)
\item L'ajout de la dimension canal (grayscale ou RGB)
\item Le redimensionnement des images si nécessaire
\item Le sous-échantillonnage si nécessaire
\item La conversion en RGB si demandé
\item L'encodage one-hot des labels
\item La création du split train/validation
\item Le batching et shuffling
}

Les datasets retournés sont des objets \code{tf_dataset} prêts à être
utilisés directement avec \code{fit()}, \code{evaluate()}, et
\code{predict()}. Les données sont des tensors TensorFlow et ne
nécessitent pas de conversion.

Pour inspecter le contenu d'un batch (à des fins de débogage),
utilisez \code{as.array()} pour convertir les tensors en arrays R :
\preformatted{
iter <- reticulate::as_iterator(datasets$train)
batch <- iter_next(iter)
batch_x <- as.array(batch[[1]])  # Images
batch_y <- as.array(batch[[2]])  # Labels
}
}
\examples{
\dontrun{
library(keras3)

# Utilisation basique (28×28, grayscale)
datasets <- mnist_to_dataset()

# Utilisation avec MobileNetV2 (48×48, RGB)
datasets <- mnist_to_dataset(
  image_size = c(48, 48),
  to_rgb = TRUE,
  batch_size = 64
)

# Version sous-échantillonnée pour entraînement rapide
datasets <- mnist_to_dataset(
  image_size = c(48, 48),
  to_rgb = TRUE,
  subsample = list(train = 10000, test = 2000),
  seed = 123
)

# Entraîner un modèle
model |> fit(
  datasets$train,
  validation_data = datasets$validation,
  epochs = 10
)
}
}
